<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <input type="text" id="ipt">
</body>
<script>

    var oIpt = document.querySelector("#ipt")

    // 核心事件代码
    function center(e) {
        console.log(e)
        console.log(this)
    }


    oIpt.oninput = debounce(center, 1000)



    function debounce(fn, time) {
        var timer = null
        return function (e) {
            // var _this = this
            // console.log(this)       //  this指向oIpt
            clearTimeout(timer)
            // setTimeout里面回调函数使用箭头函数，this指向外层函数
            timer = setTimeout(() => {
                // console.log(this)       // 使用普通函数this就是setTimeout的this，也就是window
                fn.call(this, e)
            }, time)
        }
    }



// setTimeout(function () {
//     console.log(this)
// })




















    // var oIpt = document.getElementById('ipt');

    // //核心代码
    // function center(e) {
    //     console.log("发送请求");
    //     console.log(e);
    //     console.log(this);
    // }
    //
    // //绑定表单发生变化就触发的事件
    // oIpt.oninput = debounce(center, 500) ;
    //
    //
    // //封装防抖函数
    // function debounce(fn, time) {
    //     var timer = null;
    //     //返回的这个函数是真正的事件函数，当事件触发 就是执行下边返回的函数
    //     return function (e) {
    //         //这里的this是指向的绑定事件的oIpt
    //         var _this = this;
    //         //每次输入文字后，触发事件，首先应该把之前没有执行完成的的定时器清掉
    //         clearTimeout(timer);
    //         //延迟time的时间 去触发核心函数fn
    //         timer = setTimeout(function () {
    //             fn.call(_this, e);
    //         }, time)
    //     }
    // }
</script>
</html>